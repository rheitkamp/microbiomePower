<<<<<<< HEAD
hist(Bacteroidetes)
Actinobacteria <- rpearsonI(n=1000, a=0.336087, b=8.804163, location=0, scale=1)
hist(Actinobacteria)
Fusobacteria <- rpearsonI(n=1000, a=0.01189997, b=1.20238249, location=0, scale=1)
hist(Fusobacteria)
Cyanobacteria <- rpearsonI(n=1000, a=0.4779586, b=530.5871302, location=0, scale=1)
hist(Cyanobacteria)
OD1 <- rpearsonI(n=1000, a=0.7248578, b=1575.0529200, location=0, scale=1)
hist(OD1)
TM7 <- rpearsonI(n=1000, a=0.0229654, b=99.8266026, location=0, scale=1)
hist(TM7)
DT <- rpearsonI(n=1000, a=0.3264245, b=4079.9796980, location=0, scale=1)
hist(DT)
Nitrospira <- rpearsonI(n=1000, a=3.99896e-02, b=3.99892e+0, location=0, scale=1)
hist(Nitrospira)
Planctomycetes <- rpearsonI(n=1000, a=2.364817e-02, b=1.182385e+03, location=0, scale=1)
hist(Planctomycetes)
Chloroflexi <- rpearsonI(n=1000, a=3.99896e-02, b=3.99892e+03, location=0, scale=1)
hist(Chloroflexi)
BRC1 <- rpearsonI(n=1000, a=1.233556e-02, b=1.233543e+03)
numrow <- 50
numcol <- dim(PRemainder)[2]
data <- matrix(nrow=numrow, ncol=numcol)
colnames(data) <- dimnames(PRemainder)[[2]]
rownames(data) <- rownames(data, do.NULL= FALSE, prefix= "Sample")
size <- dim(data)[1]
for (i in 1:size){
total <- 1
###BRC1
data[i,13] <- 0
total <- total - data[i,13]
###Chloroflexi
data[i,12] <- rpearsonI(n=1, a=3.99896e-02, b=3.99892e+03, location=0, scale=1)
total <- total - data[i,12]
###Planctomycetes
data[i,11] <- rpearsonI(n=1, a=1.561484e-02, b=1.561469e+03, location=0, scale=1)
total <- total - data[i,11]
###Nitrospira
data[i,10] <- rpearsonI(n=1, a=0.1735524, b=3470.8750587, location=0, scale=1)
total <- total - data[i,10]
###Deinococcus-Thermus
data[i,9] <- rpearsonI(n=1, a=0.2498125, b=1665.1668542, location=0, scale=1)
total <- total - data[i,9]
###TM7
data[i,8] <- rpearsonI(n=1, a=0.02130855, b=47.33101610, location=0, scale=1)
total <- total - data[i,8]
###OD1
data[i,7] <- rpearsonI(n=1, a=0.605873, b=903.682256, location=0, scale=1)
total <- total - data[i,7]
###Cyanobacteria
data[i,6] <- rpearsonI(n=1, a=0.3728329, b=137.7134274, location=0, scale=1)
total <- total - data[i,6]
###Fusobacteria
data[i,5] <- rpearsonI(n=1, a=0.02791087, b=1.56699613, location=0, scale=1)
total <- total - data[i, 5]
###Bacteroidetes
data[i,3] <- rpearsonI(n=1, a=0.1034732, b=2.9488343, location=0, scale=1)
total <- total - data[i,3]
###Actinobacteria
data[i,4] <- rpearsonI(n=1, a=0.2883812, b=15.0510462, location=0, scale=1)
total <- total - data[i,4]
###Firmicutes
data[i,2] <- rpearsonI(n=1, a=0.7207408, b=3.4647458, location=0, scale=1)
total <- total - data[i,2]
###Proteobacteria
data[i,1] <- total
}
View(data)
View(data)
View(data)
numrow <- 50
numcol <- dim(PRemainder)[2]
data <- matrix(nrow=numrow, ncol=numcol)
colnames(data) <- dimnames(PRemainder)[[2]]
rownames(data) <- rownames(data, do.NULL= FALSE, prefix= "Sample")
size <- dim(data)[1]
for (i in 1:size){
total <- 1
###BRC1
data[i,13] <- rpearsonI(n=1, a=1.233556e-02, b=1.233543e+03)
total <- total - data[i,13]
###Chloroflexi
data[i,12] <- rpearsonI(n=1, a=3.99896e-02, b=3.99892e+03, location=0, scale=1)
total <- total - data[i,12]
###Planctomycetes
data[i,11] <- rpearsonI(n=1, a=2.364817e-02, b=1.182385e+03, location=0, scale=1)
total <- total - data[i,11]
###Nitrospira
data[i,10] <- rpearsonI(n=1, a=3.99896e-02, b=3.99892e+0, location=0, scale=1)
total <- total - data[i,10]
###Deinococcus-Thermus
data[i,9] <- rpearsonI(n=1, a=0.3264245, b=4079.9796980, location=0, scale=1)
total <- total - data[i,9]
###TM7
data[i,8] <- rpearsonI(n=1, a=0.0229654, b=99.8266026, location=0, scale=1)
total <- total - data[i,8]
###OD1
data[i,7] <- rpearsonI(n=1, a=0.7248578, b=1575.0529200, location=0, scale=1)
total <- total - data[i,7]
###Cyanobacteria
data[i,6] <- rpearsonI(n=1, a=0.4779586, b=530.5871302, location=0, scale=1)
total <- total - data[i,6]
###Fusobacteria
data[i,5] <- rpearsonI(n=1, a=0.01189997, b=1.20238249, location=0, scale=1)
total <- total - data[i, 5]
###Actinobacteria
data[i,4] <- rpearsonI(n=1, a=a=0.336087, b=8.804163, location=0, scale=1)
total <- total - data[i,4]
###Bacteroidetes
data[i,3] <- rpearsonI(n=1, a=0.8961366, b=3.7446536, location=0, scale=1)
total <- total - data[i,3]
###Firmicutes
data[i,2] <- rpearsonI(n=1, a=0.4776035, b=1.4513283, location=0, scale=1)
total <- total - data[i,2]
###Proteobacteria
data[i,1] <- total
}
numrow <- 50
numcol <- dim(PRemainder)[2]
data <- matrix(nrow=numrow, ncol=numcol)
colnames(data) <- dimnames(PRemainder)[[2]]
rownames(data) <- rownames(data, do.NULL= FALSE, prefix= "Sample")
size <- dim(data)[1]
for (i in 1:size){
total <- 1
###BRC1
data[i,13] <- rpearsonI(n=1, a=1.233556e-02, b=1.233543e+03)
total <- total - data[i,13]
###Chloroflexi
data[i,12] <- rpearsonI(n=1, a=3.99896e-02, b=3.99892e+03, location=0, scale=1)
total <- total - data[i,12]
###Planctomycetes
data[i,11] <- rpearsonI(n=1, a=2.364817e-02, b=1.182385e+03, location=0, scale=1)
total <- total - data[i,11]
###Nitrospira
data[i,10] <- rpearsonI(n=1, a=3.99896e-02, b=3.99892e+0, location=0, scale=1)
total <- total - data[i,10]
###Deinococcus-Thermus
data[i,9] <- rpearsonI(n=1, a=0.3264245, b=4079.9796980, location=0, scale=1)
total <- total - data[i,9]
###TM7
data[i,8] <- rpearsonI(n=1, a=0.0229654, b=99.8266026, location=0, scale=1)
total <- total - data[i,8]
###OD1
data[i,7] <- rpearsonI(n=1, a=0.7248578, b=1575.0529200, location=0, scale=1)
total <- total - data[i,7]
###Cyanobacteria
data[i,6] <- rpearsonI(n=1, a=0.4779586, b=530.5871302, location=0, scale=1)
total <- total - data[i,6]
###Fusobacteria
data[i,5] <- rpearsonI(n=1, a=0.01189997, b=1.20238249, location=0, scale=1)
total <- total - data[i, 5]
###Actinobacteria
data[i,4] <- rpearsonI(n=1, a=0.336087, b=8.804163, location=0, scale=1)
total <- total - data[i,4]
###Bacteroidetes
data[i,3] <- rpearsonI(n=1, a=0.8961366, b=3.7446536, location=0, scale=1)
total <- total - data[i,3]
###Firmicutes
data[i,2] <- rpearsonI(n=1, a=0.4776035, b=1.4513283, location=0, scale=1)
total <- total - data[i,2]
###Proteobacteria
data[i,1] <- total
}
numrow <- 50
numcol <- dim(PRemainder)[2]
data <- matrix(nrow=numrow, ncol=numcol)
colnames(data) <- dimnames(PRemainder)[[2]]
rownames(data) <- rownames(data, do.NULL= FALSE, prefix= "Sample")
size <- dim(data)[1]
for (i in 1:size){
total <- 1
###BRC1
data[i,13] <- rpearsonI(n=1, a=1.233556e-02, b=1.233543e+03, location=0, scale=1)
total <- total - data[i,13]
###Chloroflexi
data[i,12] <- rpearsonI(n=1, a=3.99896e-02, b=3.99892e+03, location=0, scale=1)
total <- total - data[i,12]
###Planctomycetes
data[i,11] <- rpearsonI(n=1, a=2.364817e-02, b=1.182385e+03, location=0, scale=1)
total <- total - data[i,11]
###Nitrospira
data[i,10] <- rpearsonI(n=1, a=3.99896e-02, b=3.99892e+0, location=0, scale=1)
total <- total - data[i,10]
###Deinococcus-Thermus
data[i,9] <- rpearsonI(n=1, a=0.3264245, b=4079.9796980, location=0, scale=1)
total <- total - data[i,9]
###TM7
data[i,8] <- rpearsonI(n=1, a=0.0229654, b=99.8266026, location=0, scale=1)
total <- total - data[i,8]
###OD1
data[i,7] <- rpearsonI(n=1, a=0.7248578, b=1575.0529200, location=0, scale=1)
total <- total - data[i,7]
###Cyanobacteria
data[i,6] <- rpearsonI(n=1, a=0.4779586, b=530.5871302, location=0, scale=1)
total <- total - data[i,6]
###Fusobacteria
data[i,5] <- rpearsonI(n=1, a=0.01189997, b=1.20238249, location=0, scale=1)
total <- total - data[i, 5]
###Actinobacteria
data[i,4] <- rpearsonI(n=1, a=0.336087, b=8.804163, location=0, scale=1)
total <- total - data[i,4]
###Bacteroidetes
data[i,3] <- rpearsonI(n=1, a=0.8961366, b=3.7446536, location=0, scale=1)
total <- total - data[i,3]
###Firmicutes
data[i,2] <- rpearsonI(n=1, a=0.4776035, b=1.4513283, location=0, scale=1)
total <- total - data[i,2]
###Proteobacteria
data[i,1] <- total
}
View(data)
numrow <- 50
numcol <- dim(PRemainder)[2]
data <- matrix(nrow=numrow, ncol=numcol)
colnames(data) <- dimnames(PRemainder)[[2]]
rownames(data) <- rownames(data, do.NULL= FALSE, prefix= "Sample")
size <- dim(data)[1]
for (i in 1:size){
total <- 1
###BRC1
data[i,13] <- rpearsonI(n=1, a=1.233556e-02, b=1.233543e+03, location=0, scale=1)
total <- total - data[i,13]
###Chloroflexi
data[i,12] <- rpearsonI(n=1, a=3.99896e-02, b=3.99892e+03, location=0, scale=1)
total <- total - data[i,12]
###Planctomycetes
data[i,11] <- rpearsonI(n=1, a=2.364817e-02, b=1.182385e+03, location=0, scale=1)
total <- total - data[i,11]
###Nitrospira
data[i,10] <- rpearsonI(n=1, a=3.99896e-02, b=3.99892e+0, location=0, scale=1)
total <- total - data[i,10]
###Deinococcus-Thermus
data[i,9] <- rpearsonI(n=1, a=0.3264245, b=4079.9796980, location=0, scale=1)
total <- total - data[i,9]
###TM7
data[i,8] <- rpearsonI(n=1, a=0.0229654, b=99.8266026, location=0, scale=1)
total <- total - data[i,8]
###OD1
data[i,7] <- rpearsonI(n=1, a=0.7248578, b=1575.0529200, location=0, scale=1)
total <- total - data[i,7]
###Cyanobacteria
data[i,6] <- rpearsonI(n=1, a=0.4779586, b=530.5871302, location=0, scale=1)
total <- total - data[i,6]
###Fusobacteria
data[i,5] <- rpearsonI(n=1, a=0.01189997, b=1.20238249, location=0, scale=1)
total <- total - data[i, 5]
###Actinobacteria
data[i,4] <- rpearsonI(n=1, a=0.336087, b=8.804163, location=0, scale=1)
total <- total - data[i,4]
###Bacteroidetes
data[i,3] <- rpearsonI(n=1, a=0.8961366, b=3.7446536, location=0, scale=1)
total <- total - data[i,3]
###Firmicutes
data[i,2] <- rpearsonI(n=1, a=0.4776035, b=1.4513283, location=0, scale=1)
total <- total - data[i,2]
###Proteobacteria
data[i,1] <- total
}
View(PRemainder)
View(data)
numrow <- 50
numcol <- dim(PRemainder)[2]
data <- matrix(nrow=numrow, ncol=numcol)
colnames(data) <- dimnames(PRemainder)[[2]]
rownames(data) <- rownames(data, do.NULL= FALSE, prefix= "Sample")
size <- dim(data)[1]
for (i in 1:size){
total <- 1
###BRC1
data[i,13] <- rpearsonI(n=1, a=1.233556e-02, b=1.233543e+03, location=0, scale=1)
total <- total - data[i,13]
###Chloroflexi
data[i,12] <- rpearsonI(n=1, a=3.99896e-02, b=3.99892e+03, location=0, scale=1)
total <- total - data[i,12]
###Planctomycetes
data[i,11] <- rpearsonI(n=1, a=2.364817e-02, b=1.182385e+03, location=0, scale=1)
total <- total - data[i,11]
###Nitrospira
data[i,10] <- rpearsonI(n=1, a=3.99896e-02, b=3.99892e+0, location=0, scale=1)
total <- total - data[i,10]
###Deinococcus-Thermus
data[i,9] <- rpearsonI(n=1, a=0.3264245, b=4079.9796980, location=0, scale=1)
total <- total - data[i,9]
###TM7
data[i,8] <- rpearsonI(n=1, a=0.0229654, b=99.8266026, location=0, scale=1)
total <- total - data[i,8]
###OD1
data[i,7] <- rpearsonI(n=1, a=0.7248578, b=1575.0529200, location=0, scale=1)
total <- total - data[i,7]
###Cyanobacteria
data[i,6] <- rpearsonI(n=1, a=0.4779586, b=530.5871302, location=0, scale=1)
total <- total - data[i,6]
###Fusobacteria
data[i,5] <- rpearsonI(n=1, a=0.01189997, b=1.20238249, location=0, scale=1)
total <- total - data[i,5]
###Actinobacteria
data[i,4] <- rpearsonI(n=1, a=0.336087, b=8.804163, location=0, scale=1)
total <- total - data[i,4]
###Bacteroidetes
data[i,3] <- rpearsonI(n=1, a=0.8961366, b=3.7446536, location=0, scale=1)
total <- total - data[i,3]
###Firmicutes
data[i,2] <- rpearsonI(n=1, a=0.4776035, b=1.4513283, location=0, scale=1)
total <- total - data[i,2]
###Proteobacteria
data[i,1] <- total
}
View(data)
a <- read.table("UpperRmean.txt")
rowsize <- dim(a)[1]
colsize <- dim(a)[2]
dims <- dimnames(a)
PRemainder <- matrix(nrow=rowsize, ncol=colsize, dimnames=dims)
for(i in 1:rowsize){
total <- apply(X=a,MARGIN=1,sum)
PRemainder[i,1] <- a[i,1]/100
total <- total - a[i,1]
for(k in 2:colsize){
PRemainder[1,k] <- a[1,k]/ total
total <- total - a[1,k]
}
}
View(PRemainder)
write.table(x=PRemainder, file="PRemainderFall.csv",sep=",")
getBetaParams(0.7539,0.2381)
getBetaParams(0.698750203, 0.1658)
getBetaParams(0.456627155, 0.0899)
getBetaParams(0.466038671, 0.0336)
getBetaParams(0.812441968, 0.018)
getBetaParams(0.668316832, 0.0044)
getBetaParams(0.5, 0.00086)
getBetaParams(0.671641791, 0.00305)
getBetaParams(0.681818182, 0.0003)
getBetaParams(0.714285714, 0.00012)
getBetaParams(0.5, 0.00008)
getBetaParams(0.5, 0.00008)
###Loop
numrow <- 50
numcol <- dim(PRemainder)[2]
UpperRep <- matrix(nrow=numrow,ncol=numcol)
colnames(UpperRep) <- dimnames(PRemainder)[[2]]
rownames(UpperRep) <- rownames(UpperRep, do.NULL= FALSE, prefix= "Sample")
size <- dim(UpperRep)[1]
for (i in 1:size){
total <- 1
###Proteobacteria
UpperRep[i,1] <- rpearsonI(n=1, a=1.7133906, b=0.5593122, location=0, scale=1)
total <- total - UpperRep[i,1]
###Firmicutes
r <- rpearsonI(n=1, a=4.651839, b=2.005531, location=0, scale=1)
UpperRep[i,2] <- total*r
total <- total - UpperRep[i,2]
###Bacteroidetes
r <- rpearsonI(n=1, a=13.56189, b=16.13825, location=0, scale=1)
UpperRep[i,3] <- total*r
total <- total - UpperRep[i,3]
###Actinobacteria
r <- rpearsonI(n=1, a=102.2587, b=117.1624, location=0, scale=1)
UpperRep[i,4] <- total*r
total <- total - UpperRep[i,4]
###Fusobacteria
r <- rpearsonI(n=1, a=381.28608,  b=88.02261, location=0, scale=1)
UpperRep[i,5] <- total*r
total <- total - UpperRep[i,5]
###Cyanobacteria
r <- rpearsonI(n=1, a=7651.471, b=3797.397, location=0, scale=1)
UpperRep[i,6] <- total*r
total <- total - UpperRep[i,6]
###OD1
r <- rpearsonI(n=1, a=169009.8, b=169009.8, location=0, scale=1)
UpperRep[i,7] <- total*r
total <- total - UpperRep[i,7]
###TM7
r <- rpearsonI(n=1, a=15922.282, b=7784.227, location=0, scale=1)
UpperRep[i,8] <- total*r
total <- total - UpperRep[i,8]
###Deinococcus-Thermus
r <- rpearsonI(n=1, a=1643500.4, b=766966.9, location=0, scale=1)
UpperRep[i,9] <- total*r
total <- total - UpperRep[i,9]
###Nitrospira
r <- rpearsonI(n=1, a=10123096, b=4049238, location=0, scale=1)
UpperRep[i,10] <- total*r
total <- total - UpperRep[i,10]
###Planctomycetes
r <- rpearsonI(n=1, a=19531249, b=19531249, location=0, scale=1)
UpperRep[i,11] <- total*r
###Chloroflexi
UpperRep[i,12] <- total - UpperRep[i,11]
###BRC1
UpperRep[1:numrow,13] <- 0
}
View(UpperRep)
barchart(x=UpperRep,horizontal=FALSE, col=rainbow(13))
apply(UpperRep,2,mean)
apply(UpperRep,2,mean)*100
View(UpperRep)
apply(UppeRep,2,mean)*100
apply(UpperRep,2,mean)*100
apply(UpperRep,2,mean)*1000.
View(UpperRep)
apply(UpperRep*100,2,mean)*1000.
apply(UpperRep*100,2,mean)
colMeans(UpperRep)
colMeans(UpperRep)*100
colMeans(UpperRep)*100
colMeans(UpperRep[1])*100
colMeans(UpperRep[1:13])*100
colMeans(UpperRep[1:50,])*100
colMeans(UpperRep[,1:50])*100
colMeans(UpperRep[1,1:50])*100
colMeans(UpperRep[1:50,1])*100
library(HMP)
#Pilot Data
install.packages(c("class", "doParallel", "flexclust", "foreach", "foreign", "gdata", "gtools", "Hmisc", "igraph", "labeling", "lavaan", "maptools", "MASS", "mefa", "mefa4", "mgcv", "munsell", "nlme", "nnet", "Rcpp", "rgeos", "rgl", "robustbase", "RSQLite", "sp", "spatial", "statnet", "vegan"))
library(HMP)
#Pilot Data
#********************************************
#Loading data
data(throat)
data(tonsils)
Gp1=throat
Gp2=tonsils
#Preprocessing 1:removing taxa that are zeroes in both groups
#If the data loaded consists of columns given by taxa units and rows subjects (usually called species data),
#then the following preprocessing should be done. Note that you are using the data of the package (ranked data),
#then there is not need to do the following.
comb=rbind(Gp1,Gp2)
index=which(colSums(comb)==0)
if(length(index)>0){
Gp1=Gp1[,-index]
Gp2=Gp2[,-index]
}
#Computing and visualizing taxa frequency means for each group
mygroup <- list(Gp1,Gp2)
names(mygroup)<-c('throat','tonsils')
Sites.pi.MoM=do.call(rbind,lapply(mygroup,function(x) DM.MoM(x)$pi))
Sites.pi.MoM=Sites.pi.MoM[,order(abs(Sites.pi.MoM[1,]-Sites.pi.MoM[2,]),decreasing=T)]
#Ploting taxa frequency means
matplot(t(Sites.pi.MoM),type='o',pch=19,axes="FALSE", ann="FALSE",col=c('blue','red'),ylim=c(-0.25,0.6))
y=colnames(Sites.pi.MoM)
nc=dim((Sites.pi.MoM))[2]
axis(1,at=1:nc, lab=F, hadj=3,pos=-0.009)
text(1:nc,-0.02, srt=90,adj=1,labels=y,xpd=T, cex=1)
axis(2, las=1, at=seq(0,0.6,0.05))
legend("topright",legend=c(rownames(Sites.pi.MoM)), cex=0.8, col=c('blue','red'), bty="n",pch=19)
text(-1.5,0.01,srt=90,adj=-1,labels='Taxa Abundance',xpd=T, cex=1)
#text(21,-0.01,srt=0,adj=0,labels='Taxa Abundance',cex=1)
#Selecting taxa with weigthed average across groups above 1%
#On one part this is to facilitate convergence of the test statistics to the asymptotic
#distribution and being able to use the properties of this distribution to answer the hypothesis
#On a second part, this is also motivated by the uncertainty regarding the abundance of rare taxa,
#meaning, we do not know if their abundances are correct or not.
fit1=DM.MoM(Gp1)
fit2=DM.MoM(Gp2)
fit1$reads=apply(Gp1,1,sum)
fit2$reads=apply(Gp2,1,sum)
group.data <- list(Gp1, Gp2)
pio <- pioest(group.data)
taxaselection=which(pio>0.01)
Gp1sel=cbind(Gp1[,taxaselection],rowSums(Gp1[,-taxaselection]))
Gp2sel=cbind(Gp2[,taxaselection],rowSums(Gp2[,-taxaselection]))
nc=dim(Gp1sel)[2]
taxaselection
pio
Gp1sel=cbind(Gp1[,taxaselection],rowSums(Gp1[,-taxaselection]))
Gp2sel=cbind(Gp2[,taxaselection],rowSums(Gp2[,-taxaselection]))
Gp1sel
Gp1[,taxaselection]
Gp1[,-taxaselection]
cbind(Gp1[,taxaselection],rowSums(Gp1[,-taxaselection]))
Gp2sel=cbind(Gp2[,taxaselection],rowSums(Gp2[,-taxaselection]))
nc=dim(Gp1sel)[2]
colnames(Gp1sel)[nc]<-'Pooled taxa'
colnames(Gp2sel)[nc]<-'Pooled taxa'
C.alpha.multinomial(Gp1sel)
C.alpha.multinomial(Gp2sel)
fit1=DM.MoM((Gp1sel))
fit2=DM.MoM((Gp2sel))
fit1$reads=colSums(Gp1sel)
fit2$reads=colSums(Gp2sel)
fit1
fit1$reads
fit2
Sites.pi.MoMsel=rbind(fit1$pi,fit2$pi)
Sites.pi.MoMsel=Sites.pi.MoMsel[,order(abs(Sites.pi.MoMsel[1,]-Sites.pi.MoMsel[2,]),decreasing=T)]
rownames(Sites.pi.MoMsel)<-rownames(Sites.pi.MoM)
matplot(t(Sites.pi.MoMsel),type='o',pch=19,axes="FALSE", ann="FALSE",col=c('blue','red'),ylim=c(-0.25,0.6))
y=colnames(Sites.pi.MoMsel)
nc=dim((Sites.pi.MoMsel))[2]
axis(1,at=1:nc, lab=F, hadj=3,pos=-0.009)
text(1:nc,-0.02, srt=90,adj=1,labels=y,xpd=T, cex=1)
axis(2, las=1, at=seq(0,0.6,0.05))
legend("topright",legend=c(rownames(Sites.pi.MoMsel)), cex=0.8, col=c('blue','red'), bty="n",pch=19)
text(-1.5,0.01,srt=90,adj=-1,labels='Taxa Abundance',xpd=T, cex=1)
#text(21,-0.01,srt=0,adj=0,labels='Taxa Abundance',cex=1)
pvalue<-Xmcupo.sevsample(mygroup,dim(Gp2)[2])
pvalue
pi_2gr=rbind(fit1$pi, fit2$pi)
pi_2gr
group.theta=c(fit1$theta,fit2$theta)
group.theta
MC=10000 #number of Monte Carlo experiments
#Defining range of subjects and sample size
subjects=c(5,10,20,25) #number of subjects per group
MC=10000 #number of Monte Carlo experiments
#Defining range of subjects and sample size
subjects=c(5,10,20,25) #number of subjects per group
nreads=c(50000) #same number of reads per subject (see package to define different number of reads)
subject.reads = expand.grid(subj=subjects, reads=nreads)
range=subject.reads
=======
install.packages("venneuler")
library("venneuler", lib.loc="C:/Users/Sylvia.Cheng/Documents/R/R-3.0.1/library")
vd <- venneuler(c(A=0.3, B=0.3, C=1.1, "A&B"=0.1, "A&C"=0.2, "B&C"=0.1 ,"A&B&C"=0.1))
plot(vd)
a <- c(A.baylyi=38, A.baumannii=139, A.baylyi&A.baumannii=377)
a <- c(A.baylyi=38, A.baumannii=139, 'A.baylyi&A.baumannii'=377)
vd <- venneuler(a)
plot(vd)
fix(vd)
a <- c("A. baylyi" = 38, "A. baumannii" = 139, "A. baylyi&A. baumannii"=377)
vd <- venneuler(a)
plot(vd)
vd <- venneuler(c("A. baylyi" = 38, "A. baumannii" = 139, "A. baylyi&A. baumannii"=377))
plot(vd)
vd <- venneuler(c("A. baylyi" = 38, "A. baumannii" = 139, "A. baylyi&A. baumannii"=377))
plot(vd)
plot(vd,cex=.5)
plot(vd,cex=3)
plot2 <- venneuler(c("14 Cond Ess" = 144, "DEG" = 168, "14 Cond Ess&DEG"=330))
plot(plot2)
plot3 <- venneuler(c("MM" = 144, "3hr LB" = 168, "Dessic"=7, "41C" = 9,
"MM&3hr LB"=12, "3hr LB&Dessic"=7, "Dessic&41C"=3,
"MM&Dessic"=7, "3hr LB&41C"=10, "MM&41C"=7,
"MM&Dessic&3hr LB"=12, "3hr LB&Dessic&41C"=11,
"MM&Dessic&41C"=12,"MM&3hr LB&41C"=9,
"MM&Dessic&3hr LB&41C"=516))
plot(plot3)
plot1 <- venneuler(c("A. baylyi" = 38, "A. baumannii" = 139, "A. baylyi&A. baumannii"=377))
plot(plot1,cex.main=.5)
plot(plot1,cex.main=.1)
plot1 <- venneuler(c("A. baylyi" = 38, "A. baumannii" = 139, "A. baylyi&A. baumannii"=377))
plot(plot1,cex.main=.1)
plot1 <- venneuler(c("A. baylyi" = 38, "A. baumannii" = 139, "A. baylyi&A. baumannii"=377))
plot(plot1)
plot2 <- venneuler(c("14 Cond Ess" = 144, "DEG" = 168, "14 Cond Ess&DEG"=330))
plot(plot2)
plot(vd)
plot(plot1,ps=.1)
plot(plot1,cex=.1)
plot(plot1,cex.sub=.1)
fix(plot1)
install.packages("VennDiagram")
plot(plot1)
plot1$colors <- c(.1,.9)
plot(plot1)
plot1$colors <- c("blue","red")
plot(plot1)
plot1$colors <- c(.1,.9)
plot(plot1)
library("VennDiagram", lib.loc="C:/Users/Sylvia.Cheng/Documents/R/R-3.0.1/library")
plot1$cex <- .5
plot(plot1)
plot.VennDiagram()
install.packages("venneuler",,"http://rforge.net/",type="source")
install.packages("venneuler", , "http://rforge.net/", type = "source")
plot1 <- venneuler(c("A. baylyi" = 38, "A. baumannii" = 139, "A. baylyi&A. baumannii"=377))
plot(plot1)
plot1 <- venneuler(c("A. baylyi" = 38, "A. baumannii" = 139, "A. baylyi&A. baumannii"=377))
library("venneuler", lib.loc="C:/Users/Sylvia.Cheng/Documents/R/R-3.0.1/library")
plot1 <- venneuler(c("A. baylyi" = 38, "A. baumannii" = 139, "A. baylyi&A. baumannii"=377))
plot(plot1)
plot2 <- venneuler(c("14 Cond Ess" = 144, "DEG" = 168, "14 Cond Ess&DEG"=330))
plot(plot2)
plot3 <- venneuler(c("MM" = 144, "3hr LB" = 168, "Dessic"=7, "41C" = 9,
"MM&3hr LB"=12, "3hr LB&Dessic"=7, "Dessic&41C"=3,
"MM&Dessic"=7, "3hr LB&41C"=10, "MM&41C"=7,
"MM&Dessic&3hr LB"=12, "3hr LB&Dessic&41C"=11,
"MM&Dessic&41C"=12,"MM&3hr LB&41C"=9,
"MM&Dessic&3hr LB&41C"=516))
plot(plot3)
fix(plot1)
plot1 <- venneuler(c("A. baylyi" = 38, "A. baumannii" = 139, "A. baylyi&A. baumannii"=377),cex=.5)
plot(plot1)
plot1 <- venneuler(c("A. baylyi" = 38, "A. baumannii" = 139, "A. baylyi&A. baumannii"=377),cex=.1)
plot(plot1)
plot(plot1, font=2)
plot1 <- venneuler(c("A. baylyi" = 38, "A. baumannii" = 139, "A. baylyi&A. baumannii"=377),cex=.1)
fix(plot1)
plot1 <- venneuler(c("A. baylyi" = 38, "A. baumannii" = 139, "A. baylyi&A. baumannii"=377))
fix(plot1)
fix(plot1)
plot1 <- venneuler(c("A. baylyi" = 38, "A. baumannii" = 139, "A. baylyi&A. baumannii"=377))
plot(plot1)
plot1$labels <- rep(.5, length(plot1$labels))
plot(plot1)
plot1 <- venneuler(c("A. baylyi" = 38, "A. baumannii" = 139, "A. baylyi&A. baumannii"=377))
plot(plot1)
plot1$cex.lab <- .5
plot(plot1)
plot1 <- venneuler(c("A. baylyi" = 38, "A. baumannii" = 139, "A. baylyi&A. baumannii"=377))
plot(plot1)
plot2 <- venneuler(c("14 Cond Ess" = 144, "DEG" = 168, "14 Cond Ess&DEG"=330))
plot(plot2)
plot3 <- venneuler(c("MM" = 144, "3hr LB" = 168, "Dessic"=7, "41C" = 9,
"MM&3hr LB"=12, "3hr LB&Dessic"=7, "Dessic&41C"=3,
"MM&Dessic"=7, "3hr LB&41C"=10, "MM&41C"=7,
"MM&Dessic&3hr LB"=12, "3hr LB&Dessic&41C"=11,
"MM&Dessic&41C"=12,"MM&3hr LB&41C"=9,
"MM&Dessic&3hr LB&41C"=516))
plot(plot3)
library("VennDiagram", lib.loc="C:/Users/Sylvia.Cheng/Documents/R/R-3.0.1/library")
svg(filename="plot1")
svg(filename="plot1.svg")
svg(filename="plot1.svg")
plot(plot1)
dev.off()
svg("plot2.svg")
plot(plot2)
dev.off
dev.off()
svg("plot3.svg")
plot(plot3)
dev.off()
setRepositories()
1 2 8 9 3 6
1, 2, 8, 9, 3, 6
1
setRepositories()
setRepositories()
setRepositories()
chooseBioCmirror()
install.packages("Vennerable", repos="http://R-Forge.R-project.org")
install.packages(c("graph", "RBGL"), dependencies=TRUE)
install.packages("Vennerable", repos="http://R-Forge.R-project.org")
library(Vennerable)
fix(plot1)
plot(plot1)
fix(plot1)
plot(plot1)
plot1 <- venneuler(c("A. baylyi" = 38, "A. baumannii" = 139, "A. baylyi&A. baumannii"=377))
plot(plot1)
fix(plot1)
fix(plot1)
d
a <- read.table("test.txt")
a
apply(a,2,function(x){x*500})
read.table(test.txt)
read.table("test.txt")
a <- read.table("test.txt")
a[2]
a[2]*500
a <- read.table("test.txt")
a <- read.table("test.txt")
a <- read.table("test.txt")
a <- scan("test.txt")
read.table
a <- read.table("test.txt")
a
a <- read.table("test.txt")
a[2,1:5]
a[1:5,2]
a <- readLines("test.txt")
a
a <- read.table("test.txt")
a <- read.table("test.txt")
a <- read.table("test.txt")
a <- read.table("test.txt",blank.lines.skip=FALSE)
View(a)
a
View(a)
a <- read.table("test.txt",blank.lines.skip=FALSE)
View(a)
library(lme4)
str(Dyestuff)
Dyestuff
head(Dyestuff)
summary(Dyestuff)
str(Dyestuff2)
summary(Dyestuff2)
fm01 <- lmer(Yield ~ 1 + (1 | Batch), Dyestuff, REML=FALSE)
print(fm01)
(fm02 <- lmer(Yield ~ 1 + (1|Batch), Dyestuff2))
(fm02ML <- update(fm02, REML=FALSE))
summy(fm02a <- lm(Yield ~ 1, Dyestuff2))
summary(fm02a <- lm(Yield ~ 1, Dyestuff2))
(fm02a <- lm(Yield ~ 1, Dyestuff2))
lm(Yield ~ 1, Dyestuff2)
summary(fm02a <- lm(Yield ~ 1, Dyestuff2))
fm01ML <- lmer(Yield ~ 1|Batch, Dyestuff, REML=FALSE, verbose=1)
(fm01ML <- lmer(Yield ~ 1|Batch, Dyestuff, REML=FALSE, verbose=1))
lmer(Yield ~ 1|Batch, Dyestuff, REML=FALSE, verbose=1))
lmer(Yield ~ 1|Batch, Dyestuff, REML=FALSE, verbose=1)
fm01ML@re@Lambda
library(lme4)
re
library(lme4)
str(Dyestuff)
Dyestuff
head(Dyestuff)
summary(Dyestuff)
str(Dyestuff2)
summary(Dyestuff2)
fm01 <- lmer(Yield ~ 1 + (1 | Batch), Dyestuff, REML=FALSE)
print(fm01)
(fm02 <- lmer(Yield ~ 1 + (1|Batch), Dyestuff2))
(fm02ML <- update(fm02, REML=FALSE))
summary(fm02a <- lm(Yield ~ 1, Dyestuff2))
(fm01ML <- lmer(Yield ~ 1|Batch, Dyestuff, REML=FALSE, verbose=1))
fm01ML@re@Lambda
print(dotplot(reorder(Rail,travel)~travel,Rail,xlab="Travel time (ms)",ylab="Rail"))
Rail
fm01ML@re@Lambda
library(MEMSS)
print(dotplot(reorder(Rail,travel)~travel,Rail,xlab="Travel time (ms)",ylab="Rail"))
Rail
Rm1ML <- lmer(travel ~ 1 + (1|Rail), Rail, REML=FALSE,verbose=TRUE)
Rm1ML
Rm1ML@Zt
Rm1ML@zt
Rm1ML@Z
Rm1ML@L
Rm1ML@Zt
?lmerMod
??lmerMod
library(nlme)
library(lattice)
Rm1ML
Rm1ML@Zt
as(Rm1ML@L, "sparseMatrix")
install.packages("robustlmm")
detach("package:lme4", unload=TRUE)
install.packages("lme4", dependencies = FALSE)
install.packages("lme4", dependencies = FALSE)
install.packages("lme4", dependencies = FALSE)
install.packages("lme4", dependencies = FALSE)
install.packages("lme4", dependencies = FALSE)
install.packages("lme4", dependencies = FALSE)
install.packages("lme4", dependencies = FALSE)
library("lme4", lib.loc="C:/Users/Sylvia.Cheng/Documents/R/R-3.0.1/library")
library("MEMSS", lib.loc="C:/Users/Sylvia.Cheng/Documents/R/R-3.0.1/library")
library(lme4)
str(Dyestuff)
Dyestuff
head(Dyestuff)
summary(Dyestuff)
str(Dyestuff2)
summary(Dyestuff2)
fm01 <- lmer(Yield ~ 1 + (1 | Batch), Dyestuff, REML=FALSE)
print(fm01)
(fm02 <- lmer(Yield ~ 1 + (1|Batch), Dyestuff2))
(fm02ML <- update(fm02, REML=FALSE))
summary(fm02a <- lm(Yield ~ 1, Dyestuff2))
(fm01ML <- lmer(Yield ~ 1|Batch, Dyestuff, REML=FALSE, verbose=1))
fm01ML@re@Lambda
library(nlme)
library(lattice)
print(dotplot(reorder(Rail,travel)~travel,Rail,xlab="Travel time (ms)",ylab="Rail"))
Rail
Rm1ML <- lmer(travel ~ 1 + (1|Rail), Rail, REML=FALSE,verbose=TRUE)
Rm1ML
Rm1ML@Zt
as(Rm1ML@L, "sparseMatrix")
library(lme4)
library(MEMSS)
print(sm1 <- lmer(Reaction ~ Subject + (Days|Subject), sleepstudy))
print(sm1 <- lmer(Reaction ~ Days + (Days|Reaction), sleepstudy))
print(sm1 <- lmer(Reaction ~ Days + (Subject|Days), sleepstudy))
sleepstudy
print(sm1 <- lmer(Days ~ Reaction + (Days|Subject), sleepstudy))
print(sm1 <- lmer(Reaction ~ Days + (Days|Subject), sleepstudy))
fm01ML <- lmer(Yield ~ 1|Batch, Dyestuff, REML=FALSE, verbose=1)
fm01ML
fm01ML@A
fm01ML@L
as(fm01ML@L, "sparseMatrix")
as(fm01ML@A, "sparseMatrix")
as(fm01ML@ranef, "sparseMatrix")
as(fm01ML@ranef)
vcov(fm01ML)
as(fm01ML@vcov)
as(fm01ML@vcov, "sparseMatrix")
as(fm01ML@ST, "sparseMatrix")
as(fm01ML@vcov, "sparseMatrix")
str(Penicillin)
summary(Penicillin)
Penicillin
xtabs(~ sample + Plate, Penicillin)
xtabs(~ sample + plate, Penicillin)
xtabs(~ sample + diameter, Penicillin)
xtabs(~ plate + diameter, Penicillin)
xtabs(~ sample + plate, Penicillin)
xtabs(~ sample + plate, Penicillin)
(fm03 <- lmer(diameter ~ 1 + (1|plate)))
(fm03 <- lmer(diameter ~ 1 + (1|plate) + (1|sample), Penicillin))
ranef(fm03)
ranef(fm03,postVar=TRUE)
ranef(fm03,postVar=FALSE)
setwd("~/data sim")
Premainder <- function(x) {
rowsize <- dim(x)[1]
colsize <- dim(x)[2]
dims <- dimnames(x)[[2]]
y <- matrix(nrow=rowsize, ncol=colsize)
for(i in 1:rowsize){
total <- apply(X=x,MARGIN=1,sum)
y[i,1] <- x[i,1]/100
total <- total - x[i,1]
for(k in 2:colsize){
y[i,k] <- x[i,k]/ total
total <- total - x[i,k]
}
}
return(matrix(y,nrow=colsize, ncol=rowsize, dimnames=list(dims, "Mean")))
}
Fallmean <- read.table("UpperRFall.txt")
FallSD <- read.table("FallSD.txt")
SDDimRow <- dimnames(FallSD)[[2]]
FallSD <- matrix(FallSD,nrow=13,ncol=1,dimnames=list(SDDimRow,"SD"))
mode(FallSD) <- "numeric"
FallSD <- FallSD/100
apply(Fallmean,MARGIN=1,sum)
(PRemainder <- Premainder(Fallmean))
Premainder <- function(x) {
rowsize <- dim(x)[1]
colsize <- dim(x)[2]
dims <- dimnames(x)[[2]]
y <- matrix(nrow=rowsize, ncol=colsize)
for(i in 1:rowsize){
total <- apply(X=x,MARGIN=1,sum)
y[i,1] <- x[i,1]/100
total <- total - x[i,1]
for(k in 2:colsize){
y[i,k] <- x[i,k]/ total
total <- total - x[i,k]
}
}
return(matrix(y,nrow=colsize, ncol=rowsize, dimnames=list(dims, "Mean")))
}
(PRemainder <- Premainder(Fallmean))
(Fallmean <- read.table("UpperRFall.txt"))
>>>>>>> 51de3d11a99c1b6748e8db79791bc71317395477
