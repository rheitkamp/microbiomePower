ADControl
newdata <- ADControl[order(Firmicutes)]
newdata <- ADControl[order()]
View(newdata)
newdata <- ADControl[order(ADControl)]
newdata <- order(ADControl)
sort.default(ADControl)
sort(Firmicute)
newdata <- ADControl[order(Firmicute),]
View(ADControl)
newdata <- ADControl[order(Firmicutes),]
nADControl <- data.matrix(ADControl)
newdata <- nADControl[order(Firmicutes),]
attach(ADControl)
sort(Firmicutes)
newdata <- ADControl[order(Firmicutes),]
View(newdata)
Barchart.data(newdata)
Barchart.data(newdata)
detach(ADControl)
barchart(data=newdata)
install.packages("ggplot")
install.packages("ggplot2")
source('~/.active-rstudio-document')
Barchart.data(ADControl)
attach(ADControl)
newdata <- ADControl[order(Firmicutes),]
detach(ADControl)
Barchart.data(newdata)
source('~/.active-rstudio-document')
barchart(x=nADControl)
barchart(x=nADControl,horizontal=TRUE)
barchart(x=nADControl,horizontal=FALSE)
for(i in 1:rowsize){
total <- 100
PRemainder[i,1] <- a[i,1]/100
total <- total - a[i,1]
for(k in 2:colsize){
PRemainder[1,k] <- a[1,k]/ total
total <- total - sum(a[1,1:k-1])
}
}
i <- 1
k <- 1
total <- 100
PRemainder[i,1] <- a[i,1]/100
View(PRemainder)
PRemainder <- matrix(nrow=rowsize, ncol=colsize, dimnames=dims)
i <- 1
k <- 1
PRemainder[i,1] <- a[i,1]/100
View(PRemainder)
total <- total - a[i,1]
PRemainder[1,k] <- a[1,k]/ total
View(PRemainder)
PRemainder <- matrix(nrow=rowsize, ncol=colsize, dimnames=dims)
View(PRemainder)
i <- 1
k <- 1
total <- 100
total <- apply(X=a,MARGIN=1,sum)
PRemainder[i,1] <- a[i,1]/100
total <- total - a[i,1]
k <- 2
PRemainder[1,k] <- a[1,k]/ total
View(PRemainder)
total <- total - sum(a[1,1:k-1])
total
total <- 100
total <- total - a[i,1]
total <- total - sum(a[1,1:k-1])
a[1:0]
a[1,1:0]
a[1,1:1]
total <- 100
total <- total - a[i,1]
total <- total - sum(a[1,1:k-1])
total <- 100
total <- total - a[i,1]
total <- total - sum(a[1,k-1])
total <- total - a[i,1]
total <- total - a[1,k-1]
total <- 100
total <- total - a[i,1]
total <- total - a[1,k-1]
total <- 100
total <- total - a[i,1]
total <- total - a[1,k]
a <- read.table("UpperRmean.txt")
rowsize <- dim(a)[1]
colsize <- dim(a)[2]
dims <- dimnames(a)
PRemainder <- matrix(nrow=rowsize, ncol=colsize, dimnames=dims)
for(i in 1:rowsize){
total <- apply(X=a,MARGIN=1,sum)
PRemainder[i,1] <- a[i,1]/100
total <- total - a[i,1]
for(k in 2:colsize){
PRemainder[1,k] <- a[1,k]/ total
total <- total - a[1,k]
}
}
View(PRemainder)
e <- PRemainder
total <- apply(X=a,MARGIN=1,sum)
PRemainder[1,1] <- a[1,1]/100
total <- total - a[1,1]
PRemainder[1,2] <- a[1,2]/total
total <- total - a[1,2]
PRemainder[1,3] <- a[1,3]/total
total <- total - a[1,3]
PRemainder[1,4] <- a[1,4]/total
total <- total - a[1,4]
PRemainder[1,5] <- a[1,5]/total
total <- total - a[1,5]
PRemainder[1,6] <- a[1,6]/total
total <- total - a[1,6]
PRemainder[1,7] <- a[1,7]/total
total <- total - a[1,7]
PRemainder[1,8] <- a[1,8]/total
total <- total - a[1,8]
PRemainder[1,9] <- a[1,9]/total
total <- total - a[1,9]
PRemainder[1,10] <- a[1,10]/total
total <- total - a[1,10]
PRemainder[1,11] <- a[1,11]/total
total <- total - a[1,11]
PRemainder[1,12] <- a[1,12]/total
total <- total - a[1,12]
PRemainder[1,13] <- a[1,13]/total
View(PRemainder)
View(e)
View(PRemainder)
Proteobacteria <-rpearsonI(n=100, a=1.71339, b=0.559312, location=0, scale=1)
mean(Proteobacteria)
sd(Proteobacteria)
Proteobacteria <-rpearsonI(n=1000, a=1.71339, b=0.559312, location=0, scale=1)
mean(Proteobacteria)
sd(Proteobacteria)
hist(Proteobacteria,100)
Proteobacteria <-rpearsonI(n=10, a=1.71339, b=0.559312, location=0, scale=1)
hist(Proteobacteria,100)
Proteobacteria <-rpearsonI(n=100, a=1.71339, b=0.559312, location=0, scale=1)
hist(Proteobacteria,100)
Proteobacteria
Firmicutes <- rpearsonI(n=1000, a=4.65184, b=2.00553, location=0, scale=1)
mean(Firmicutes)
sd(Firmicutes)
hist(Bacteroidetes)
Bacteroidetes <- rpearsonI(n=1000, a=13.5619, b=16.1382, location=0, scale=1)
hist(Bacteroidetes)
mean(Bacteroidetes)
sd(Bacteroidetes)
Actinobacteria rpearsonI(n=1000, a=102.259, b=117.162, location=0, scale=1 )
Actinobacteria <- rpearsonI(n=1000, a=102.259, b=117.162, location=0, scale=1 )
hist(Actinobacteria)
hist(Actinobacteria,100)
Cyanobacteria <- rpearsonI(n=1000, a=7651.47, b=3797.4, location=0, scale=1)
hist(Cyanobacteria,100)
mean(Cyanobacteria)
OD1 <- rpearsonI(n=1000, a=169010, b=169010, location=0, scale=1)
hist(OD1,100)
matrix(dimnames=dims)
numcol <- dim(PRemainder)[1]
numcol
numcol <- dim(PRemainder)[2]
numcol
dimnames(PRemainder)
dimnames(PRemainder)[2]
numrow <- 100
numcol <- dim(PRemainder)[2]
names <- dimnames(PRemainder)[2]
UpperRep <- matrix(nrow=numrow,ncol=numcol, dimnames=names)
fix(names)
UpperRep <- matrix(nrow=numrow,ncol=numcol, dimnames=numrow,names)
UpperRep <- matrix(nrow=numrow,ncol=numcol, dimnames=(numrow,names))
UpperRep <- matrix(nrow=numrow,ncol=numcol, dimnames=c(numrow,names))
getBetaParams <- function(mean, sd) {
m <- (1-mean)/mean
n <- 1 + m
alpha <- (1/n)*(m/(sd^2*n^2)-1)
beta <- m * alpha
params <- c(alpha, beta)
return(params)
}
getBetaParams(.7539, .2381)
UpperRep <- matrix(nrow=numrow,ncol=numcol, dimnames=list(c(1:numrow),
c(names)))
UpperRep <- matrix(nrow=numrow,ncol=numcol)
UpperRep[1,1] <- rpearsonI(n=1000, a=1.71339, b=0.559312, location=0, scale=1)
View(UpperRep)
UpperRep[1,1]
UpperRep[1,1] <- rpearsonI(n=1, a=1.71339, b=0.559312, location=0, scale=1)
View(UpperRep)
UpperRep[2,1] <- rpearsonI(n=1, a=1.71339, b=0.559312, location=0, scale=1)
View(UpperRep)
UpperRep[3,1] <- rpearsonI(n=1, a=1.71339, b=0.559312, location=0, scale=1)
View(PRemainder)
View(UpperRep)
UpperRep[4,1] <- rpearsonI(n=1, a=1.71339, b=0.559312, location=0, scale=1)
View(UpperRep)
View(PRemainder)
View(UpperRep)
total <- 1
UpperRep <- matrix(nrow=numrow,ncol=numcol)
UpperRep[1,1] <- rpearsonI(n=1, a=1.71339, b=0.559312, location=0, scale=1)
total <- total - UpperRep[1,1]
r <- rpearsonI(n=1000, a=4.65184, b=2.00553, location=0, scale=1)
UpperRep[1,2] <- (total*r)
r <- rpearsonI(n=1, a=4.65184, b=2.00553, location=0, scale=1)
UpperRep[1,2] <- (total*r)
total <- total -UpperRep[1,2]
View(UpperRep)
numrow <- 100
numcol <- dim(PRemainder)[2]
names <- dimnames(PRemainder)[2]
UpperRep <- matrix(nrow=numrow,ncol=numcol)
size <- dim(UpperRep)[1]
for (i in 1:size){
total <- 1
###Proteobacteria
UpperRep[i,1] <- rpearsonI(n=1, a=1.71339, b=0.559312, location=0, scale=1)
total <- total - UpperRep[i,1]
###Firmicutes
r <- rpearsonI(n=1, a=4.65184, b=2.00553, location=0, scale=1)
UpperRep[i,2] <- total*r
total <- total - UpperRep[i,2]
###Bacteroidetes
r <- rpearsonI(n=1, a=13.5619, b=16.1382, location=0, scale=1)
UpperRep[i,3] <- total*r
total <- total - UpperRep[i,3]
###Actinobacteria
r <- rpearsonI(n=1, a=102.259, b=117.162, location=0, scale=1)
UpperRep[i,4] <- total*r
total <- total - UpperRep[i,4]
###Fusobacteria
r <- rpearsonI(n=1, a=17.8716, b=4.12579, location=0, scale=1)
UpperRep[i,5] <- total*r
total <- total - UpperRep[i,5]
###Cyanobacteria
r <- rpearsonI(n=1000, a=7651.47, b=3797.4, location=0, scale=1)
UpperRep[i,6] <- total*r
total <- total - UpperRep[i,6]
###OD1
r <- rpearsonI(n=1000, a=169010, b=169010, location=0, scale=1)
UpperRep[i,7] <- total*r
total <- total - UpperRep[i,7]
###TM7
r <- rpearsonI(n=1000, a=15922.3, b=7784.23, location=0, scale=1)
UpperRep[i,8] <- total*r
total <- total - UpperRep[i,8]
###Deinococcus-Thermus
r <- rpearsonI(n=1000, a=1.6435e6, b=766967, location=0, scale=1)
UpperRep[i,9] <- total*r
total <- total - UpperRep[i,9]
###Nitrospira
r <- rpearsonI(n=1000, a=1.01231e7, b=4.04924e6, location=0, scale=1)
UpperRep[i,10] <- total*r
total <- total - UpperRep[i,10]
###Planctomycetes
r <- rpearsonI(n=1000, a=1.95312e7, b=1.95312e7, location=0, scale=1)
UpperRep[i,11] <- total*r
###Chloroflexi
UpperRep[i,12] <- total - UpperRep[i,11]
###BRC1
}
###Loop
numrow <- 100
numcol <- dim(PRemainder)[2]
names <- dimnames(PRemainder)[2]
UpperRep <- matrix(nrow=numrow,ncol=numcol)
size <- dim(UpperRep)[1]
for (i in 1:size){
total <- 1
###Proteobacteria
UpperRep[i,1] <- rpearsonI(n=1, a=1.71339, b=0.559312, location=0, scale=1)
total <- total - UpperRep[i,1]
###Firmicutes
r <- rpearsonI(n=1, a=4.65184, b=2.00553, location=0, scale=1)
UpperRep[i,2] <- total*r
total <- total - UpperRep[i,2]
###Bacteroidetes
r <- rpearsonI(n=1, a=13.5619, b=16.1382, location=0, scale=1)
UpperRep[i,3] <- total*r
total <- total - UpperRep[i,3]
###Actinobacteria
r <- rpearsonI(n=1, a=102.259, b=117.162, location=0, scale=1)
UpperRep[i,4] <- total*r
total <- total - UpperRep[i,4]
###Fusobacteria
r <- rpearsonI(n=1, a=17.8716, b=4.12579, location=0, scale=1)
UpperRep[i,5] <- total*r
total <- total - UpperRep[i,5]
###Cyanobacteria
r <- rpearsonI(n=1, a=7651.47, b=3797.4, location=0, scale=1)
UpperRep[i,6] <- total*r
total <- total - UpperRep[i,6]
###OD1
r <- rpearsonI(n=1, a=169010, b=169010, location=0, scale=1)
UpperRep[i,7] <- total*r
total <- total - UpperRep[i,7]
###TM7
r <- rpearsonI(n=1, a=15922.3, b=7784.23, location=0, scale=1)
UpperRep[i,8] <- total*r
total <- total - UpperRep[i,8]
###Deinococcus-Thermus
r <- rpearsonI(n=1, a=1.6435e6, b=766967, location=0, scale=1)
UpperRep[i,9] <- total*r
total <- total - UpperRep[i,9]
###Nitrospira
r <- rpearsonI(n=1, a=1.01231e7, b=4.04924e6, location=0, scale=1)
UpperRep[i,10] <- total*r
total <- total - UpperRep[i,10]
###Planctomycetes
r <- rpearsonI(n=1, a=1.95312e7, b=1.95312e7, location=0, scale=1)
UpperRep[i,11] <- total*r
###Chloroflexi
UpperRep[i,12] <- total - UpperRep[i,11]
###BRC1
}
View(PRemainder)
View(UpperRep)
apply(UpperRep,1,sum)
UpperRep[1:100,13] <- 0
View(UpperRep)
apply(UpperRep,1,sum)
apply(UpperRep,2,mean)
apply(UpperRep,2,mean)*100
Barchart.data(UpperRep)
barchart(x=UpperRep,horizontal=FLASE)
barchart(x=UpperRep,horizontal=TRUE)
barchart(x=UpperRep,horizontal=FALSE)
###Loop
numrow <- 50
numcol <- dim(PRemainder)[2]
names <- dimnames(PRemainder)[2]
UpperRep <- matrix(nrow=numrow,ncol=numcol)
size <- dim(UpperRep)[1]
for (i in 1:size){
total <- 1
###Proteobacteria
UpperRep[i,1] <- rpearsonI(n=1, a=1.71339, b=0.559312, location=0, scale=1)
total <- total - UpperRep[i,1]
###Firmicutes
r <- rpearsonI(n=1, a=4.65184, b=2.00553, location=0, scale=1)
UpperRep[i,2] <- total*r
total <- total - UpperRep[i,2]
###Bacteroidetes
r <- rpearsonI(n=1, a=13.5619, b=16.1382, location=0, scale=1)
UpperRep[i,3] <- total*r
total <- total - UpperRep[i,3]
###Actinobacteria
r <- rpearsonI(n=1, a=102.259, b=117.162, location=0, scale=1)
UpperRep[i,4] <- total*r
total <- total - UpperRep[i,4]
###Fusobacteria
r <- rpearsonI(n=1, a=17.8716, b=4.12579, location=0, scale=1)
UpperRep[i,5] <- total*r
total <- total - UpperRep[i,5]
###Cyanobacteria
r <- rpearsonI(n=1, a=7651.47, b=3797.4, location=0, scale=1)
UpperRep[i,6] <- total*r
total <- total - UpperRep[i,6]
###OD1
r <- rpearsonI(n=1, a=169010, b=169010, location=0, scale=1)
UpperRep[i,7] <- total*r
total <- total - UpperRep[i,7]
###TM7
r <- rpearsonI(n=1, a=15922.3, b=7784.23, location=0, scale=1)
UpperRep[i,8] <- total*r
total <- total - UpperRep[i,8]
###Deinococcus-Thermus
r <- rpearsonI(n=1, a=1.6435e6, b=766967, location=0, scale=1)
UpperRep[i,9] <- total*r
total <- total - UpperRep[i,9]
###Nitrospira
r <- rpearsonI(n=1, a=1.01231e7, b=4.04924e6, location=0, scale=1)
UpperRep[i,10] <- total*r
total <- total - UpperRep[i,10]
###Planctomycetes
r <- rpearsonI(n=1, a=1.95312e7, b=1.95312e7, location=0, scale=1)
UpperRep[i,11] <- total*r
###Chloroflexi
UpperRep[i,12] <- total - UpperRep[i,11]
###BRC1
}
barchart(x=UpperRep,horizontal=FALSE)
numrow <- 50
numcol <- dim(PRemainder)[2]
names <- dimnames(PRemainder)[2]
UpperRep <- matrix(nrow=numrow,ncol=numcol)
size <- dim(UpperRep)[1]
for (i in 1:size){
total <- 1
###Proteobacteria
UpperRep[i,1] <- rpearsonI(n=1, a=1.71339, b=0.559312, location=0, scale=1)
total <- total - UpperRep[i,1]
###Firmicutes
r <- rpearsonI(n=1, a=4.65184, b=2.00553, location=0, scale=1)
UpperRep[i,2] <- total*r
total <- total - UpperRep[i,2]
###Bacteroidetes
r <- rpearsonI(n=1, a=13.5619, b=16.1382, location=0, scale=1)
UpperRep[i,3] <- total*r
total <- total - UpperRep[i,3]
###Actinobacteria
r <- rpearsonI(n=1, a=102.259, b=117.162, location=0, scale=1)
UpperRep[i,4] <- total*r
total <- total - UpperRep[i,4]
###Fusobacteria
r <- rpearsonI(n=1, a=17.8716, b=4.12579, location=0, scale=1)
UpperRep[i,5] <- total*r
total <- total - UpperRep[i,5]
###Cyanobacteria
r <- rpearsonI(n=1, a=7651.47, b=3797.4, location=0, scale=1)
UpperRep[i,6] <- total*r
total <- total - UpperRep[i,6]
###OD1
r <- rpearsonI(n=1, a=169010, b=169010, location=0, scale=1)
UpperRep[i,7] <- total*r
total <- total - UpperRep[i,7]
###TM7
r <- rpearsonI(n=1, a=15922.3, b=7784.23, location=0, scale=1)
UpperRep[i,8] <- total*r
total <- total - UpperRep[i,8]
###Deinococcus-Thermus
r <- rpearsonI(n=1, a=1.6435e6, b=766967, location=0, scale=1)
UpperRep[i,9] <- total*r
total <- total - UpperRep[i,9]
###Nitrospira
r <- rpearsonI(n=1, a=1.01231e7, b=4.04924e6, location=0, scale=1)
UpperRep[i,10] <- total*r
total <- total - UpperRep[i,10]
###Planctomycetes
r <- rpearsonI(n=1, a=1.95312e7, b=1.95312e7, location=0, scale=1)
UpperRep[i,11] <- total*r
###Chloroflexi
UpperRep[i,12] <- total - UpperRep[i,11]
###BRC1
UpperRep[1:rumrow,13] <- 0
}
numrow <- 50
numcol <- dim(PRemainder)[2]
names <- dimnames(PRemainder)[2]
UpperRep <- matrix(nrow=numrow,ncol=numcol)
size <- dim(UpperRep)[1]
for (i in 1:size){
total <- 1
###Proteobacteria
UpperRep[i,1] <- rpearsonI(n=1, a=1.71339, b=0.559312, location=0, scale=1)
total <- total - UpperRep[i,1]
###Firmicutes
r <- rpearsonI(n=1, a=4.65184, b=2.00553, location=0, scale=1)
UpperRep[i,2] <- total*r
total <- total - UpperRep[i,2]
###Bacteroidetes
r <- rpearsonI(n=1, a=13.5619, b=16.1382, location=0, scale=1)
UpperRep[i,3] <- total*r
total <- total - UpperRep[i,3]
###Actinobacteria
r <- rpearsonI(n=1, a=102.259, b=117.162, location=0, scale=1)
UpperRep[i,4] <- total*r
total <- total - UpperRep[i,4]
###Fusobacteria
r <- rpearsonI(n=1, a=17.8716, b=4.12579, location=0, scale=1)
UpperRep[i,5] <- total*r
total <- total - UpperRep[i,5]
###Cyanobacteria
r <- rpearsonI(n=1, a=7651.47, b=3797.4, location=0, scale=1)
UpperRep[i,6] <- total*r
total <- total - UpperRep[i,6]
###OD1
r <- rpearsonI(n=1, a=169010, b=169010, location=0, scale=1)
UpperRep[i,7] <- total*r
total <- total - UpperRep[i,7]
###TM7
r <- rpearsonI(n=1, a=15922.3, b=7784.23, location=0, scale=1)
UpperRep[i,8] <- total*r
total <- total - UpperRep[i,8]
###Deinococcus-Thermus
r <- rpearsonI(n=1, a=1.6435e6, b=766967, location=0, scale=1)
UpperRep[i,9] <- total*r
total <- total - UpperRep[i,9]
###Nitrospira
r <- rpearsonI(n=1, a=1.01231e7, b=4.04924e6, location=0, scale=1)
UpperRep[i,10] <- total*r
total <- total - UpperRep[i,10]
###Planctomycetes
r <- rpearsonI(n=1, a=1.95312e7, b=1.95312e7, location=0, scale=1)
UpperRep[i,11] <- total*r
###Chloroflexi
UpperRep[i,12] <- total - UpperRep[i,11]
###BRC1
UpperRep[1:numrow,13] <- 0
}
barchart(x=UpperRep,horizontal=FALSE)
barchart(x=UpperRep,horizontal=FALSE, rectangles.col="rainbow")
barchart(x=UpperRep,horizontal=FALSE, rectangles.col="blue")
barchart(x=UpperRep,horizontal=FALSE, rectangles.col="black")
barchart(x=UpperRep,horizontal=FALSE, col="black")
barchart(x=UpperRep,horizontal=FALSE, col="rainbow")
barchart(x=UpperRep,horizontal=FALSE, col="blue")
barchart(x=UpperRep,horizontal=FALSE)
barchart(x=UpperRep,horizontal=FALSE, col=c("blue", "red", "green"))
barchart(x=UpperRep,horizontal=FALSE, col=c("blue", "red", "green", "yellow", "orange"))
barchart(x=UpperRep,horizontal=FALSE, col=c("blue", "red", "green", "yellow", "orange", "purple"))
barchart(x=UpperRep,horizontal=FALSE)
barchart(x=UpperRep,horizontal=FALSE, col="rainbow"
)
barchart(x=UpperRep,horizontal=FALSE)
apply(UpperRep,2,mean)
apply(UpperRep,2,mean)*100
